# apiVersion: networking.k8s.io/v1
# kind: IngressClass
# metadata:
#   name: kong
# spec:
#   controller: ingress-controllers.konghq.com/kong
# ---
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: kongatrial
  annotations:
    konghq.com/strip-path: "true"
    # konghq.com/rewrite-target: /konga/register

spec:
  ingressClassName: kong
  rules:
  - host:
    http:
      paths:
      - path: /
        pathType: ImplementationSpecific
        backend:
          service:
            name: openapi-konga
            port:
              number: 1337
      - path: /konga
        pathType: ImplementationSpecific
        backend:
          service:
            name: openapi-konga
            port:
              number: 1337
---
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: frontend
  annotations:
    konghq.com/strip-path: 'true'
spec:
  ingressClassName: kong
  rules:
  - host: 
    http:
      paths:
      - path: /frontend
        pathType: ImplementationSpecific
        backend:
          service:
            name: openapi-frontend
            port:
              number: 3000
---
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: backend
  annotations:
    konghq.com/strip-path: 'true'
spec:
  ingressClassName: kong
  rules:
  - host: 
    http:
      paths:
      - path: /backend
        pathType: Prefix
        backend:
          service:
            name: openapi-backend
            port:
              number: 8999
# apiVersion: v1
# kind: Service
# metadata:
#   labels:
#     app: echo
#   name: echo
# spec:
#   ports:
#   - port: 1025
#     name: tcp
#     protocol: TCP
#     targetPort: 1025
#   - port: 1026
#     name: udp
#     protocol: TCP
#     targetPort: 1026
#   - port: 1027
#     name: http
#     protocol: TCP
#     targetPort: 1027
#   selector:
#     app: echo
# ---
# apiVersion: apps/v1
# kind: Deployment
# metadata:
#   labels:
#     app: echo
#   name: echo
# spec:
#   replicas: 1
#   selector:
#     matchLabels:
#       app: echo
#   strategy: {}
#   template:
#     metadata:
#       creationTimestamp: null
#       labels:
#         app: echo
#     spec:
#       containers:
#       - image: kong/go-echo:latest
#         name: echo
#         ports:
#         - containerPort: 1027
#         env:
#           - name: NODE_NAME
#             valueFrom:
#               fieldRef:
#                 fieldPath: spec.nodeName
#           - name: POD_NAME
#             valueFrom:
#               fieldRef:
#                 fieldPath: metadata.name
#           - name: POD_NAMESPACE
#             valueFrom:
#               fieldRef:
#                 fieldPath: metadata.namespace
#           - name: POD_IP
#             valueFrom:
#               fieldRef:
#                 fieldPath: status.podIP
#         resources: {}
# ---
# apiVersion: networking.k8s.io/v1
# kind: Ingress
# metadata:
#   name: echo
#   annotations:
#     konghq.com/strip-path: 'true'
#     # kubernetes.io/ingress.global-static-ip-name: 192.168.49.2
# spec:
#   ingressClassName: kong
#   rules:
#   - host: kong.example
#     http:
#       paths:
#       - path: /echo
#         pathType: ImplementationSpecific
#         backend:
#           service:
#             name: echo
#             port:
#               number: 1027
# ---
# kind: Service
# apiVersion: v1
# metadata:
#   name: proxy-to-httpbin
# spec:
#   ports:
#   - protocol: TCP
#     port: 80
#   type: ExternalName
#   externalName: httpbin.org
# ---
# apiVersion: networking.k8s.io/v1
# kind: Ingress
# metadata:
#   name: proxy-from-k8s-to-httpbin
#   annotations:
#     konghq.com/strip-path: 'true'
# spec:
#   ingressClassName: kong
#   rules:
#   - host: kong.example
#     http:
#       paths:
#       - path: /httpbin
#         pathType: ImplementationSpecific
#         backend:
#           service:
#             name: proxy-to-httpbin
#             port:
#               number: 1027
# curl -i -H 'Host: kong.example' http://192.168.49.2:30505
